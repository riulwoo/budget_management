"use strict";(self.webpackChunkbudget_management=self.webpackChunkbudget_management||[]).push([[115],{115:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var n=a(540),r=a(591),c=a(17),l=a(688);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach(function(t){o(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function o(e,t,a){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c,l,s=[],m=!0,i=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;m=!1}else for(;!(m=(n=c.call(a)).done)&&(s.push(n.value),s.length!==t);m=!0);}catch(e){i=!0,r=e}finally{try{if(!m&&null!=a.return&&(l=a.return(),Object(l)!==l))return}finally{if(i)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}const v=function(){var e=(0,c.E)(),t=e.categories,a=e.transactions,r=d((0,n.useState)("loading"),2),s=r[0],m=r[1],o=d((0,n.useState)([]),2),u=o[0],v=o[1];(0,n.useEffect)(function(){console.log("📊 CategoryChart useEffect 실행:",{categoriesCount:(null==t?void 0:t.length)||0,transactionsCount:(null==a?void 0:a.length)||0}),m("loading");var e=setTimeout(function(){try{var e=(null==t?void 0:t.filter(function(e){return"expense"===e.type}))||[];if(0===e.length||!a||0===a.length)return console.log("📊 차트 데이터 없음:",{expenseCategories:e,transactions:a}),void m("empty");var n=(new Date).toISOString().slice(0,7),r=a.filter(function(e){return e.date&&e.date.startsWith(n)});console.log("📊 월별 거래내역:",{currentMonth:n,monthlyTransactions:r});var c=e.map(function(e){var t=r.filter(function(t){return"expense"===t.type&&(t.category_id===e.id||t.category_name===e.name)}).reduce(function(e,t){return e+parseFloat(t.amount||0)},0);return i(i({},e),{},{amount:t})}).filter(function(e){return e.amount>0}).sort(function(e,t){return t.amount-e.amount}).slice(0,8);if(console.log("📊 카테고리 데이터:",c),0===c.length)return void m("empty");var l=c.reduce(function(e,t){return e+t.amount},0),s=c.map(function(e,t){return i(i({},e),{},{percentage:(e.amount/l*100).toFixed(1),color:e.color||f(t)})});v({categories:s,totalAmount:l}),m("ready")}catch(e){console.error("📊 차트 데이터 처리 오류:",e),m("empty")}},300);return function(){return clearTimeout(e)}},[t,a]);var f=function(e){var t=["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#FF6384","#C9CBCF"];return t[e%t.length]};return n.createElement("div",{className:"category-chart-container"},function(){switch(s){case"loading":return n.createElement("div",{className:"text-center py-4"},n.createElement("div",{className:"spinner-border text-primary",role:"status"},n.createElement("span",{className:"visually-hidden"},"차트 로딩중...")),n.createElement("p",{className:"mt-2 text-muted"},"차트를 불러오는 중..."));case"empty":return n.createElement("div",{className:"text-center py-4"},n.createElement("i",{className:"fas fa-chart-pie fa-3x text-muted mb-3"}),n.createElement("h6",{className:"text-muted"},"이번 달 지출 내역이 없습니다"),n.createElement("small",{className:"text-muted"},"거래를 추가하면 차트가 표시됩니다."));case"ready":return n.createElement("div",{className:"css-chart-container"},n.createElement("div",{className:"chart-summary text-center mb-4"},n.createElement("h6",{className:"text-muted mb-1"},"이번 달 총 지출"),n.createElement("h4",{className:"text-danger fw-bold mb-0"},(0,l.ej)(u.totalAmount))),n.createElement("div",{className:"category-bars"},u.categories.map(function(e,t){return n.createElement("div",{key:e.id,className:"category-bar-item mb-3"},n.createElement("div",{className:"d-flex justify-content-between align-items-center mb-1"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"category-color-indicator me-2",style:{backgroundColor:e.color,width:"12px",height:"12px",borderRadius:"50%"}}),n.createElement("span",{className:"fw-semibold small"},e.name)),n.createElement("div",{className:"text-end"},n.createElement("div",{className:"fw-bold small text-danger"},(0,l.ej)(e.amount)),n.createElement("div",{className:"text-muted",style:{fontSize:"0.75rem"}},e.percentage,"%"))),n.createElement("div",{className:"progress",style:{height:"8px",borderRadius:"4px"}},n.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:"".concat(e.percentage,"%"),backgroundColor:e.color,transition:"width 0.6s ease"},"aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"})))})),n.createElement("div",{className:"mt-4"},n.createElement("div",{className:"donut-chart-container d-flex justify-content-center"},n.createElement("div",{className:"donut-chart position-relative",style:{width:"200px",height:"200px"}},n.createElement("svg",{width:"200",height:"200",className:"donut-svg"},u.categories.map(function(e,t){for(var a=0,r=0;r<t;r++)a+=parseFloat(u.categories[r].percentage);var c=a/100*360-90,l=(a+parseFloat(e.percentage))/100*360-90,s=c*Math.PI/180,m=l*Math.PI/180,i=parseFloat(e.percentage)>50?1:0,o=100+70*Math.cos(s),d=100+70*Math.sin(s),v=100+70*Math.cos(m),f=100+70*Math.sin(m),E=100+40*Math.cos(m),b=100+40*Math.sin(m),N=100+40*Math.cos(s),y=100+40*Math.sin(s),p="\n                        M ".concat(o," ").concat(d,"\n                        A 70 70 0 ").concat(i," 1 ").concat(v," ").concat(f,"\n                        L ").concat(E," ").concat(b,"\n                        A 40 40 0 ").concat(i," 0 ").concat(N," ").concat(y,"\n                        Z\n                      ");return n.createElement("path",{key:e.id,d:p,fill:e.color,stroke:"#fff",strokeWidth:"2",className:"donut-segment",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))",transition:"all 0.3s ease"}})})),n.createElement("div",{className:"donut-center position-absolute top-50 start-50 translate-middle text-center"},n.createElement("div",{className:"small text-muted"},"총 지출"),n.createElement("div",{className:"fw-bold text-danger",style:{fontSize:"0.9rem"}},(0,l.ej)(u.totalAmount)))))));default:return null}}())},f=function(){var e=(0,c.E)().transactions,t=((0,r.A)().currentUser,e.slice(0,5));return 0===t.length?n.createElement("p",{className:"text-muted"},"거래내역이 없습니다."):n.createElement("div",null,t.map(function(e){return n.createElement("div",{key:e.id,className:"d-flex justify-content-between align-items-center mb-2 transaction-item"},n.createElement("div",null,n.createElement("div",{className:"fw-bold"},e.description||"설명 없음"),n.createElement("small",{className:"text-muted"},(0,l.Yq)(e.date)),e.category_name&&n.createElement("span",{className:"badge category-badge ms-2",style:{backgroundColor:e.category_color}},e.category_name)),n.createElement("div",{className:"text-end"},n.createElement("div",{className:"fw-bold ".concat("income"===e.type?"income":"expense")},"income"===e.type?"+":"-",(0,l.ej)(e.amount))))}))};function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var b=(0,n.lazy)(function(){return a.e(275).then(a.bind(a,275))});const N=function(){var e,t,a=(0,r.A)().currentUser,s=(0,c.E)(),m=s.monthlyStats,i=s.totalBalance,o=s.loading,d=s.addTransaction,u=s.transactions,N=s.categories,y=(e=(0,n.useState)(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c,l,s=[],m=!0,i=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;m=!1}else for(;!(m=(n=c.call(a)).done)&&(s.push(n.value),s.length!==t);m=!0);}catch(e){i=!0,r=e}finally{try{if(!m&&null!=a.return&&(l=a.return(),Object(l)!==l))return}finally{if(i)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return E(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?E(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=y[0],g=y[1],h=m.income.total-m.expense.total,x=(null==u?void 0:u.filter(function(e){var t=(new Date).toISOString().split("T")[0];return e.date===t}).length)||0,w=function(){var e=new Date;e.setDate(e.getDate()-7);var t=(null==u?void 0:u.filter(function(t){return new Date(t.date)>=e}))||[];return t.filter(function(e){return"income"===e.type}).reduce(function(e,t){return e+parseFloat(t.amount)},0)-t.filter(function(e){return"expense"===e.type}).reduce(function(e,t){return e+parseFloat(t.amount)},0)};return o?n.createElement("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"}},n.createElement("div",{className:"text-center"},n.createElement("div",{className:"spinner-border text-primary mb-3",role:"status"},n.createElement("span",{className:"visually-hidden"},"Loading...")),n.createElement("p",null,"대시보드를 불러오는 중..."))):a?n.createElement("div",{className:"dashboard-container"},n.createElement("div",{className:"dashboard-header"},n.createElement("div",{className:"row align-items-center mb-4"},n.createElement("div",{className:"col-12 col-md-8 mb-3 mb-md-0"},n.createElement("h2",{className:"dashboard-title"},n.createElement("i",{className:"fas fa-tachometer-alt me-2"}),n.createElement("span",{className:"d-none d-sm-inline"},"대시보드"),n.createElement("span",{className:"d-sm-none"},"Dashboard")),n.createElement("p",{className:"dashboard-subtitle text-muted mb-0"},n.createElement("span",{className:"d-none d-md-inline"},"안녕하세요, ",null==a?void 0:a.username,"님! 오늘도 좋은 하루 되세요 ✨"),n.createElement("span",{className:"d-md-none"},"안녕하세요, ",null==a?void 0:a.username,"님! ✨"))),n.createElement("div",{className:"col-12 col-md-4 text-end"},n.createElement("button",{className:"btn btn-primary dashboard-add-btn w-100 w-md-auto",onClick:function(){return g(!0)}},n.createElement("i",{className:"fas fa-plus me-2"}),n.createElement("span",{className:"d-none d-sm-inline"},"거래 추가"),n.createElement("span",{className:"d-sm-none"},"추가"))))),n.createElement("div",{className:"row mb-4"},n.createElement("div",{className:"col-lg-3 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-stat-card income-card"},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"stat-icon bg-success"},n.createElement("i",{className:"fas fa-arrow-up"})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-label"},"이번 달 수입"),n.createElement("div",{className:"stat-value text-success"},(0,l.ej)(m.income.total)),n.createElement("div",{className:"stat-subtitle"},m.income.count,"건의 수입")))))),n.createElement("div",{className:"col-lg-3 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-stat-card expense-card"},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"stat-icon bg-danger"},n.createElement("i",{className:"fas fa-arrow-down"})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-label"},"이번 달 지출"),n.createElement("div",{className:"stat-value text-danger"},(0,l.ej)(m.expense.total)),n.createElement("div",{className:"stat-subtitle"},m.expense.count,"건의 지출")))))),n.createElement("div",{className:"col-lg-3 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-stat-card ".concat(h>=0?"balance-positive-card":"balance-negative-card")},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"stat-icon ".concat(h>=0?"bg-info":"bg-warning")},n.createElement("i",{className:"fas ".concat(h>=0?"fa-plus":"fa-minus")})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-label"},"이번 달 잔액"),n.createElement("div",{className:"stat-value ".concat(h>=0?"text-info":"text-warning")},(0,l.ej)(Math.abs(h))),n.createElement("div",{className:"stat-subtitle"},h>=0?"흑자":"적자"," 운영")))))),n.createElement("div",{className:"col-lg-3 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-stat-card total-balance-card"},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"stat-icon bg-primary"},n.createElement("i",{className:"fas fa-wallet"})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-label"},"총 잔액"),n.createElement("div",{className:"stat-value text-primary"},(0,l.ej)(i.current_balance)),n.createElement("div",{className:"stat-subtitle"},"초기 자본금 포함"))))))),n.createElement("div",{className:"row mb-4"},n.createElement("div",{className:"col-lg-4 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-quick-stat"},n.createElement("div",{className:"card-body text-center"},n.createElement("i",{className:"fas fa-calendar-day fa-2x mb-2 text-primary"}),n.createElement("div",{className:"quick-stat-value"},x),n.createElement("div",{className:"quick-stat-label"},"오늘의 거래")))),n.createElement("div",{className:"col-lg-4 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-quick-stat"},n.createElement("div",{className:"card-body text-center"},n.createElement("i",{className:"fas fa-calendar-week fa-2x mb-2 text-success"}),n.createElement("div",{className:"quick-stat-value"},(0,l.ej)(Math.abs(w()))),n.createElement("div",{className:"quick-stat-label"},"이번 주 ",w()>=0?"수익":"손실")))),n.createElement("div",{className:"col-lg-4 col-md-6 mb-3"},n.createElement("div",{className:"card dashboard-quick-stat"},n.createElement("div",{className:"card-body text-center"},n.createElement("i",{className:"fas fa-tags fa-2x mb-2 text-info"}),n.createElement("div",{className:"quick-stat-value"},(null==N?void 0:N.length)||0),n.createElement("div",{className:"quick-stat-label"},"활성 카테고리"))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-lg-8 mb-4"},n.createElement("div",{className:"card dashboard-content-card"},n.createElement("div",{className:"card-header dashboard-card-header"},n.createElement("div",{className:"d-flex align-items-center justify-content-between"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"header-icon bg-primary me-3"},n.createElement("i",{className:"fas fa-history"})),n.createElement("div",null,n.createElement("h5",{className:"mb-0"},"최근 거래내역"),n.createElement("small",{className:"text-muted"},"최신 거래 내역을 확인하세요"))),n.createElement("div",{className:"header-actions"},n.createElement("button",{className:"btn btn-outline-primary btn-sm"},n.createElement("i",{className:"fas fa-eye me-1"}),"전체보기")))),n.createElement("div",{className:"card-body"},n.createElement(f,null)))),n.createElement("div",{className:"col-lg-4 mb-4"},n.createElement("div",{className:"card dashboard-content-card"},n.createElement("div",{className:"card-header dashboard-card-header"},n.createElement("div",{className:"d-flex align-items-center"},n.createElement("div",{className:"header-icon bg-success me-3"},n.createElement("i",{className:"fas fa-chart-pie"})),n.createElement("div",null,n.createElement("h5",{className:"mb-0"},"카테고리별 지출"),n.createElement("small",{className:"text-muted"},"지출 분석을 확인하세요")))),n.createElement("div",{className:"card-body"},n.createElement(v,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("div",{className:"card dashboard-summary-card"},n.createElement("div",{className:"card-body"},n.createElement("div",{className:"row text-center"},n.createElement("div",{className:"col-md-3 col-6 mb-3 mb-md-0"},n.createElement("div",{className:"summary-item"},n.createElement("i",{className:"fas fa-coins text-warning fa-2x mb-2"}),n.createElement("div",{className:"summary-value"},(0,l.ej)(i.current_balance)),n.createElement("div",{className:"summary-label"},"현재 총 자산"))),n.createElement("div",{className:"col-md-3 col-6 mb-3 mb-md-0"},n.createElement("div",{className:"summary-item"},n.createElement("i",{className:"fas fa-chart-line text-info fa-2x mb-2"}),n.createElement("div",{className:"summary-value"},h>=0?"+":"",(0,l.ej)(h)),n.createElement("div",{className:"summary-label"},"이번 달 수지"))),n.createElement("div",{className:"col-md-3 col-6 mb-3 mb-md-0"},n.createElement("div",{className:"summary-item"},n.createElement("i",{className:"fas fa-calendar-alt text-purple fa-2x mb-2"}),n.createElement("div",{className:"summary-value"},(null==u?void 0:u.length)||0),n.createElement("div",{className:"summary-label"},"총 거래 건수"))),n.createElement("div",{className:"col-md-3 col-6 mb-3 mb-md-0"},n.createElement("div",{className:"summary-item"},n.createElement("i",{className:"fas fa-percentage text-success fa-2x mb-2"}),n.createElement("div",{className:"summary-value"},m.expense.total>0?Math.round(m.income.total/m.expense.total*100):0,"%"),n.createElement("div",{className:"summary-label"},"수입 대비 지출률")))))))),p&&n.createElement(n.Suspense,{fallback:n.createElement("div",{className:"modal fade show",style:{display:"block"}},n.createElement("div",{className:"modal-dialog"},n.createElement("div",{className:"modal-content"},n.createElement("div",{className:"modal-body text-center p-4"},n.createElement("div",{className:"spinner-border text-primary",role:"status"},n.createElement("span",{className:"visually-hidden"},"로딩 중..."))))))},n.createElement(b,{show:p,onHide:function(){return g(!1)},onSubmit:d,categories:N}))):n.createElement("div",{className:"text-center mt-5"},n.createElement("div",{className:"card dashboard-welcome-card"},n.createElement("div",{className:"card-body"},n.createElement("i",{className:"fas fa-tachometer-alt fa-4x text-primary mb-3"}),n.createElement("h3",null,"대시보드에 오신 것을 환영합니다!"),n.createElement("p",null,"로그인하여 가계부 관리를 시작해보세요."))))}}}]);