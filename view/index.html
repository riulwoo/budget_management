<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가계부 관리 시스템</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.css" rel="stylesheet">
    <style>
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .main-content {
            background-color: #f8f9fa;
            min-height: 100vh;
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
        }
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            border: none;
        }
        .transaction-item {
            transition: all 0.3s ease;
        }
        .transaction-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .income {
            color: #28a745;
        }
        .expense {
            color: #dc3545;
        }
        .category-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .modal-content {
            border-radius: 15px;
        }
        .form-control, .form-select {
            border-radius: 10px;
        }
        .user-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .auth-buttons {
            margin-bottom: 20px;
        }
        /* ---- 달력 관련 스타일 한 번만 선언 ---- */
        .calendar-container, .main-content, .col-md-9, .col-lg-10 {
            width: 100% !important;
            max-width: 100% !important;
            min-width: 0 !important;
            box-sizing: border-box !important;
        }
        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .calendar-grid {
            display: grid !important;
            grid-template-columns: repeat(7, 1fr) !important;
            min-width: 0 !important;
            width: 100% !important;
            gap: 1px !important;
            background: #e9ecef !important;
            border-radius: 10px !important;
            overflow: hidden !important;
            border: 1px solid #dee2e6 !important;
            box-sizing: border-box !important;
        }
        .calendar-day, .calendar-day-header {
            min-width: 0 !important;
            min-height: 60px !important;
            box-sizing: border-box !important;
        }
        .calendar-day-header {
            background: #f8f9fa;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9rem;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
        }
        .calendar-day {
            background: white;
            padding: 8px;
            min-height: 80px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            border-right: 1px solid #f0f0f0;
            border-bottom: 1px solid #f0f0f0;
        }
        .calendar-day:hover {
            background: #f8f9fa;
            transform: scale(1.02);
        }
        .calendar-day.other-month {
            background: #f8f9fa;
            color: #adb5bd;
        }
        .calendar-day.today {
            background: #e3f2fd;
            font-weight: bold;
            border: 2px solid #2196f3;
        }
        .calendar-day.has-transactions {
            background: #e8f5e8;
        }
        .day-number {
            font-weight: bold;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }
        .day-transactions {
            font-size: 0.7rem;
            color: #6c757d;
            margin-bottom: 2px;
        }
        .day-income {
            color: #28a745;
            font-size: 0.7rem;
            font-weight: bold;
            margin-bottom: 1px;
        }
        .day-expense {
            color: #dc3545;
            font-size: 0.7rem;
            font-weight: bold;
            margin-bottom: 1px;
        }
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .calendar-nav button {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: #667eea;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        .calendar-nav button:hover {
            color: #764ba2;
            background: #f8f9fa;
        }
        .month-year-display {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            min-width: 120px;
            text-align: center;
        }
        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .calendar-container {
                padding: 15px;
            }
            .calendar-header {
                flex-direction: column;
                align-items: stretch;
            }
            .calendar-nav {
                justify-content: center;
            }
            .calendar-day {
                min-height: 60px;
                padding: 6px;
            }
            .day-number {
                font-size: 0.8rem;
            }
            .day-income, .day-expense {
                font-size: 0.6rem;
            }
            .month-year-display {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- 사이드바 -->
            <div class="col-md-3 col-lg-2 sidebar p-0">
                <div class="p-4 text-white">
                    <h4 class="mb-4"><i class="fas fa-wallet me-2"></i>가계부</h4>
                    
                    <!-- 사용자 정보 -->
                    <div id="user-info" class="user-info" style="display: none;">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-user me-2"></i>
                            <span id="username-display"></span>
                        </div>
                        <button class="btn btn-sm btn-outline-light w-100 mb-2" onclick="showProfileModal()">
                            <i class="fas fa-user-cog me-2"></i>프로필
                        </button>
                        <button class="btn btn-sm btn-outline-light w-100" onclick="logout()">
                            <i class="fas fa-sign-out-alt me-2"></i>로그아웃
                        </button>
                    </div>
                    
                    <!-- 로그인 버튼 -->
                    <div id="auth-buttons" class="auth-buttons">
                        <button class="btn btn-outline-light w-100 mb-2" onclick="showLoginModal()">
                            <i class="fas fa-sign-in-alt me-2"></i>로그인
                        </button>
                        <button class="btn btn-outline-light w-100" onclick="showRegisterModal()">
                            <i class="fas fa-user-plus me-2"></i>회원가입
                        </button>
                    </div>
                    
                    <nav class="nav flex-column">
                        <a class="nav-link text-white mb-2" href="#" onclick="showDashboard()">
                            <i class="fas fa-tachometer-alt me-2"></i>대시보드
                        </a>
                        <a class="nav-link text-white mb-2" href="#" onclick="showCalendar()">
                            <i class="fas fa-calendar-alt me-2"></i>달력
                        </a>
                        <a class="nav-link text-white mb-2" href="#" onclick="showTransactions()">
                            <i class="fas fa-list me-2"></i>거래내역
                        </a>
                        <a class="nav-link text-white mb-2" href="#" onclick="showCategories()">
                            <i class="fas fa-tags me-2"></i>카테고리
                        </a>
                        <a class="nav-link text-white mb-2" href="#" onclick="showStats()">
                            <i class="fas fa-chart-pie me-2"></i>통계
                        </a>
                        <a class="nav-link text-white mb-2" href="#" onclick="showBalanceSettings()" id="balance-settings-link" style="display: none;">
                            <i class="fas fa-wallet me-2"></i>자본금 설정
                        </a>
                    </nav>
                </div>
            </div>

            <!-- 메인 콘텐츠 -->
            <div class="col-md-9 col-lg-10 main-content p-4">
                <!-- 헤더 -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 id="page-title">대시보드</h2>
                    <button class="btn btn-primary" onclick="showAddTransactionModal()" id="add-transaction-btn" style="display: none;">
                        <i class="fas fa-plus me-2"></i>거래 추가
                    </button>
                </div>

                <!-- 대시보드 -->
                <div id="dashboard-content">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="card-body text-center">
                                    <h5>이번 달 수입</h5>
                                    <h3 id="monthly-income">₩0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="card-body text-center">
                                    <h5>이번 달 지출</h5>
                                    <h3 id="monthly-expense">₩0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="card-body text-center">
                                    <h5>이번 달 잔액</h5>
                                    <h3 id="monthly-balance">₩0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <h5>총 잔액</h5>
                                    <h3 id="total-balance">₩0</h3>
                                    <small>초기 자본금 포함</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5>최근 거래내역</h5>
                                </div>
                                <div class="card-body">
                                    <div id="recent-transactions"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5>카테고리별 지출</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="category-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 달력 -->
                <div id="calendar-content" style="display: none;">
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <div class="calendar-nav">
                                <button onclick="previousMonth()">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span class="month-year-display" id="month-year-display"></span>
                                <button onclick="nextMonth()">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <button class="btn btn-primary" onclick="showAddTransactionModal()" id="calendar-add-btn" style="display: none;">
                                <i class="fas fa-plus me-2"></i>거래 추가
                            </button>
                        </div>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- 달력 내용이 JavaScript로 생성됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- 거래내역 -->
                <div id="transactions-content" style="display: none;">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5>거래내역</h5>
                            <div>
                                <input type="month" id="transaction-month" class="form-control" onchange="loadTransactions()">
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="transactions-list"></div>
                        </div>
                    </div>
                </div>

                <!-- 카테고리 -->
                <div id="categories-content" style="display: none;">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5>카테고리 관리</h5>
                            <button class="btn btn-primary btn-sm" onclick="showAddCategoryModal()" id="add-category-btn" style="display: none;">
                                <i class="fas fa-plus me-2"></i>카테고리 추가
                            </button>
                        </div>
                        <div class="card-body">
                            <!-- 검색 및 필터 -->
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <input type="text" class="form-control" id="category-search" placeholder="카테고리명 검색..." onkeyup="filterCategories()">
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select" id="category-type-filter" onchange="filterCategories()">
                                        <option value="">모든 타입</option>
                                        <option value="income">수입</option>
                                        <option value="expense">지출</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select" id="category-sort" onchange="filterCategories()">
                                        <option value="name">이름순</option>
                                        <option value="type">타입순</option>
                                        <option value="usage">사용순</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- 카테고리 통계 -->
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <div class="card bg-primary text-white">
                                        <div class="card-body text-center">
                                            <h6>전체 카테고리</h6>
                                            <h4 id="total-categories">0</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-success text-white">
                                        <div class="card-body text-center">
                                            <h6>수입 카테고리</h6>
                                            <h4 id="income-categories">0</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-danger text-white">
                                        <div class="card-body text-center">
                                            <h6>지출 카테고리</h6>
                                            <h4 id="expense-categories">0</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-info text-white">
                                        <div class="card-body text-center">
                                            <h6>사용 중</h6>
                                            <h4 id="used-categories">0</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="categories-list"></div>
                        </div>
                    </div>
                </div>

                <!-- 통계 -->
                <div id="stats-content" style="display: none;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>월별 수입/지출</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="monthly-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>카테고리별 분포</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="stats-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 로그인 모달 -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">로그인</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="login-form">
                        <div class="mb-3">
                            <label class="form-label">사용자명</label>
                            <input type="text" class="form-control" id="login-username" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">비밀번호</label>
                            <input type="password" class="form-control" id="login-password" required>
                        </div>
                    </form>
                    <div class="text-center mt-3">
                        <small class="text-muted">
                            <a href="#" onclick="showFindUsernameModal()" class="text-decoration-none">아이디 찾기</a> | 
                            <a href="#" onclick="showResetPasswordModal()" class="text-decoration-none">비밀번호 재설정</a>
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="login()">로그인</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 아이디 찾기 모달 -->
    <div class="modal fade" id="findUsernameModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">아이디 찾기</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        가입 시 등록한 이메일 주소를 입력하시면 아이디를 찾을 수 있습니다.
                    </div>
                    <form id="find-username-form">
                        <div class="mb-3">
                            <label class="form-label">이메일 주소</label>
                            <input type="email" class="form-control" id="find-username-email" required>
                        </div>
                    </form>
                    <div id="find-username-result" class="alert" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="findUsername()">아이디 찾기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 비밀번호 재설정 모달 -->
    <div class="modal fade" id="resetPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">비밀번호 재설정</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        가입 시 등록한 이메일 주소를 입력하시면 임시 비밀번호를 발급해드립니다.
                    </div>
                    <form id="reset-password-form">
                        <div class="mb-3">
                            <label class="form-label">이메일 주소</label>
                            <input type="email" class="form-control" id="reset-password-email" required>
                        </div>
                    </form>
                    <div id="reset-password-result" class="alert" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="resetPassword()">비밀번호 재설정</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 회원가입 모달 -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">회원가입</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="register-form">
                        <div class="mb-3">
                            <label class="form-label">사용자명</label>
                            <input type="text" class="form-control" id="register-username" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">이메일</label>
                            <input type="email" class="form-control" id="register-email" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">비밀번호</label>
                            <input type="password" class="form-control" id="register-password" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">비밀번호 확인</label>
                            <input type="password" class="form-control" id="register-password-confirm" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="register()">회원가입</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 프로필 모달 -->
    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">프로필</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">사용자명</label>
                        <input type="text" class="form-control" id="profile-username" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">이메일</label>
                        <input type="email" class="form-control" id="profile-email" readonly>
                    </div>
                    <hr>
                    <h6>비밀번호 변경</h6>
                    <form id="change-password-form">
                        <div class="mb-3">
                            <label class="form-label">현재 비밀번호</label>
                            <input type="password" class="form-control" id="current-password">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">새 비밀번호</label>
                            <input type="password" class="form-control" id="new-password">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">새 비밀번호 확인</label>
                            <input type="password" class="form-control" id="new-password-confirm">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="changePassword()">비밀번호 변경</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 거래 추가 모달 -->
    <div class="modal fade" id="addTransactionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">거래 추가</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="transaction-form">
                        <div class="mb-3">
                            <label class="form-label">타입</label>
                            <select class="form-select" id="transaction-type" required>
                                <option value="">선택하세요</option>
                                <option value="income">수입</option>
                                <option value="expense">지출</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">금액</label>
                            <input type="number" class="form-control" id="transaction-amount" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">설명</label>
                            <input type="text" class="form-control" id="transaction-description">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">카테고리</label>
                            <select class="form-select" id="transaction-category">
                                <option value="">선택하세요</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">날짜</label>
                            <input type="date" class="form-control" id="transaction-date" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="addTransaction()">추가</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 카테고리 추가 모달 -->
    <div class="modal fade" id="addCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">카테고리 추가</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="category-form">
                        <div class="mb-3">
                            <label class="form-label">카테고리명</label>
                            <input type="text" class="form-control" id="category-name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">타입</label>
                            <select class="form-select" id="category-type" required>
                                <option value="">선택하세요</option>
                                <option value="income">수입</option>
                                <option value="expense">지출</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">색상</label>
                            <div class="d-flex gap-2 align-items-center">
                                <input type="color" class="form-control" id="category-color" value="#007bff" style="width: 60px;">
                                <span id="color-preview" class="badge" style="background-color: #007bff; color: white;">미리보기</span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="addCategory()">추가</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 카테고리 수정 모달 -->
    <div class="modal fade" id="editCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">카테고리 수정</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-category-form">
                        <input type="hidden" id="edit-category-id">
                        <div class="mb-3">
                            <label class="form-label">카테고리명</label>
                            <input type="text" class="form-control" id="edit-category-name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">타입</label>
                            <select class="form-select" id="edit-category-type" required>
                                <option value="">선택하세요</option>
                                <option value="income">수입</option>
                                <option value="expense">지출</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">색상</label>
                            <div class="d-flex gap-2 align-items-center">
                                <input type="color" class="form-control" id="edit-category-color" value="#007bff" style="width: 60px;">
                                <span id="edit-color-preview" class="badge" style="background-color: #007bff; color: white;">미리보기</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">사용 현황</label>
                            <div id="category-usage-info" class="text-muted small"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="updateCategory()">수정</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 자본금 설정 모달 -->
    <div class="modal fade" id="balanceSettingsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">초기 자본금 설정</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        초기 자본금을 설정하면 총 잔액 계산에 반영됩니다.
                    </div>
                    <form id="balance-form">
                        <div class="mb-3">
                            <label class="form-label">초기 자본금</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="initial-balance-amount" min="0" step="1000" required>
                                <span class="input-group-text">원</span>
                            </div>
                            <small class="text-muted">현재 총 잔액: <span id="current-total-balance">₩0</span></small>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted">초기 자본금: <span id="detail-initial-balance">₩0</span></small>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">총 수입: <span id="detail-total-income">₩0</span></small>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted">총 지출: <span id="detail-total-expense">₩0</span></small>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">현재 잔액: <span id="detail-current-balance">₩0</span></small>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="saveInitialBalance()">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 날짜별 거래내역 모달 -->
    <div class="modal fade" id="dayTransactionsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-calendar-day me-2"></i>
                        <span id="day-transactions-date"></span> 거래내역
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="day-transactions-list">
                        <!-- 거래내역이 여기에 표시됩니다 -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="add-transaction-for-date">
                        <i class="fas fa-plus me-2"></i>새 거래 추가
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="js/app.js"></script>
</body>
</html>